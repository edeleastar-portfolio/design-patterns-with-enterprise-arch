<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.css"
          type="text/css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/railscasts.min.css"
          rel="stylesheet"/>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery.address/1.6/jquery.address.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/kotlin.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <style>
      

body {
  font-family: "Open Sans", "Helvetica", "Helvetica Neue",  "Arial", sans-serif;
  font-size:90%;
  color: black;
}

p {
  margin: 0.5em;
}

pre code {
  font-family: "Monaco";
  font-size: 100%;
}

img {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  margin:10px;
}

h1, h2, h3 {
  border-bottom:thin solid black;
  margin-bottom: 0.5em;
  margin-top: 1em;
}

h1 {
  font-style:italic;
  font-size:130%;
}

h2 {
  font-size:110%;
}

h3 {
  font-size:100%;
}



      

html, body {
  height: 100%;
  margin: 0;
}
.wrapper {
  height: 100%;
  display: flex;
  flex-direction: column;
}
.footer {
  background: white;
  text-align: right;
}
.content {
  flex: 1;
  overflow: auto;
}



    </style>
  </head>

  <body class="uk-background-muted">
    <div class="wrapper">
      <div class="content">
        <div style="height:1000px;">
          
  

  <div class="ui fixed top pointing inverted stackable menu labmenu">
    <header class="header item">
      <i id="toc" class="sitemap icon"></i>
      
        <a href="../index.html"> Patterns Thinking  </a>
      
    </header>
    <div class="right tab-menu menu">
      
        <a class="item" data-tab="Lab-06a">
          Lab-06a
        </a>
      
        <a class="item" data-tab="01">
          01
        </a>
      
        <a class="item" data-tab="02">
          02
        </a>
      
        <a class="item" data-tab="03">
          03
        </a>
      
        <a class="item" data-tab="04">
          04
        </a>
      
        <a class="item" data-tab="05">
          05
        </a>
      
        <a class="item" data-tab="06">
          06
        </a>
      
        <a class="item" data-tab="07">
          07
        </a>
      
        <a class="item" data-tab="08">
          08
        </a>
      
        <a class="item" data-tab="Solution">
          Solution
        </a>
      
    </div>
  </div>


  

  <div class="ui pushable">
    <div class="ui inverted labeled icon left inline vertical sidebar menu">
      <br><br>
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic01-context/book/index.html">Lab-01 </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic02-template-method-strategy/book-template-method-strategy/index.html">Lab-02 </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic03-command/book-a-command/index.html">Lab-03 </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic03-command/book-a-prototype/index.html">lab-03b </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic05-observer-gof-1/book-android-1/index.html">Lab-05a </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic05-observer-gof-1/book-android-2/index.html">Lab-05b </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic06-gof-2-posa/book-android-3/index.html">Lab-06a </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic06-gof-2-posa/book-android-4/index.html">Lab-06b </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic06-gof-2-posa/book-android-6/index.html">Lab-06c </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic07-enterprise-architecture/book-1/index.html">Lab-07a </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic07-enterprise-architecture/book-2/index.html">Lab-07b </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic08-design-techniques/book/index.html">Lab-08 </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic09-principles-and-styles/book/index.html">Lab-09 </a>
        
      
        
          <a class="item"
             href="https://edeleastar-portfolio.github.io/design-patterns-with-enterprise-arch//topic10-architecture-patterns/book/index.html">Lab-10 </a>
        
      
    </div>
    <div class="pusher" tabindex="-1">
      <div class="ui basic segment">
        <br>
        
          <div class="ui tab segment lab" data-tab="Lab-06a">
            <h1>Objectives</h1>
<p>Build a set of views to support signup/login and navigation. Incorporate suitable models. Introduce the Facade pattern to encapsulate Model access.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="01">
            <h1>Setup</h1>
<p>This is the archive of the las lab:</p>
<p> <a href="https://github.com/wit-design-patterns-2016/pacemaker-android/releases/tag/V2">https://github.com/wit-design-patterns-2016/pacemaker-android/releases/tag/V2</a></p>
<p>The starting point for this lab is a small evolution on the last lab, can can be downloaded here:</p>
<p> <a href="https://github.com/wit-design-patterns-2016/pacemaker-android/releases/tag/V3">https://github.com/wit-design-patterns-2016/pacemaker-android/releases/tag/V3</a></p>
<p>This version has  a refactored package structure:</p>
<p><img src="img/04.png" alt=""></p>
<p>Also, the adapter is reconfigured to load a layout for each row:</p>
<p><img src="img/05.png" alt=""></p>

          </div>
        
          <div class="ui tab segment lab" data-tab="02">
            <h1>Welcome View</h1>
<p>Design a new activity to look like this:</p>
<p><img src="img/00.png" alt=""></p>
<p>You may end up with new entries in the strings.xml file:</p>
<h2>res/values/strings.xml</h2>
<pre><code>    &lt;string name=&quot;welcomeLogin&quot;&gt;Login&lt;/string&gt;
    &lt;string name=&quot;welcomeSignup&quot;&gt;Sign up&lt;/string&gt;</code></pre>
<p>And this layout:</p>
<h2>res/layout/activity_welcome.xml</h2>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:id=&quot;@+id/RelativeLayout&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot; &gt;

    &lt;Button
        android:id=&quot;@+id/welcomeLogin&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignParentTop=&quot;true&quot;
        android:layout_centerHorizontal=&quot;true&quot;
        android:layout_marginTop=&quot;102dp&quot;
        android:onClick=&quot;loginPressed&quot;
        android:text=&quot;@string/welcomeLogin&quot; /&gt;

    &lt;Button
        android:id=&quot;@+id/welcomeSignup&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_centerHorizontal=&quot;true&quot;
        android:layout_centerVertical=&quot;true&quot;
        android:onClick=&quot;signupPressed&quot;
        android:text=&quot;@string/welcomeSignup&quot; /&gt;

&lt;/RelativeLayout&gt;</code></pre>

          </div>
        
          <div class="ui tab segment lab" data-tab="03">
            <h1>Signup View</h1>
<p>Design a new activity to look like this:</p>
<p><img src="img/01.png" alt=""></p>
<p>You may end up with new entries in the strings.xml file:</p>
<h2>res/values/strings.xml</h2>
<pre><code>    &lt;string name=&quot;signupTitle&quot;&gt;Sign up for the Pacemaker&lt;/string&gt;
    &lt;string name=&quot;signupSubtitle&quot;&gt;Enter details below&lt;/string&gt;
    &lt;string name=&quot;signupFirstname&quot;&gt;First name&lt;/string&gt;
    &lt;string name=&quot;signupLastName&quot;&gt;Last Name&lt;/string&gt;
    &lt;string name=&quot;signupEmail&quot;&gt;Email&lt;/string&gt;
    &lt;string name=&quot;signupPassword&quot;&gt;Password&lt;/string&gt;
    &lt;string name=&quot;signupRegister&quot;&gt;Register&lt;/string&gt;</code></pre>
<p>And this layout:</p>
<h2>res/layout/activity_signup.xml</h2>
<pre><code class="lang-xml">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:paddingBottom=&quot;@dimen/activity_vertical_margin&quot;
    android:paddingLeft=&quot;@dimen/activity_horizontal_margin&quot;
    android:paddingRight=&quot;@dimen/activity_horizontal_margin&quot;
    android:paddingTop=&quot;@dimen/activity_vertical_margin&quot;
    tools:context=&quot;org.pacemaker.controllers.Signup&quot; &gt;

    &lt;TextView
        android:id=&quot;@+id/signupTitle&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignParentLeft=&quot;true&quot;
        android:layout_alignParentTop=&quot;true&quot;
        android:layout_marginLeft=&quot;32dp&quot;
        android:layout_marginTop=&quot;28dp&quot;
        android:text=&quot;@string/signupTitle&quot;
        android:textAppearance=&quot;?android:attr/textAppearanceMedium&quot; /&gt;

    &lt;TextView
        android:id=&quot;@+id/signupSubtitle&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignLeft=&quot;@+id/signupTitle&quot;
        android:layout_below=&quot;@+id/signupTitle&quot;
        android:layout_marginLeft=&quot;55dp&quot;
        android:layout_marginTop=&quot;30dp&quot;
        android:text=&quot;@string/signupSubtitle&quot;
        android:textAppearance=&quot;?android:attr/textAppearanceSmall&quot; /&gt;

    &lt;EditText
        android:id=&quot;@+id/firstName&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignParentLeft=&quot;true&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:layout_below=&quot;@+id/signupSubtitle&quot;
        android:layout_marginTop=&quot;40dp&quot;
        android:ems=&quot;10&quot;
        android:hint=&quot;@string/signupFirstname&quot;
        android:inputType=&quot;textPersonName&quot;/&gt;

        &lt;requestFocus /&gt;

    &lt;EditText
        android:id=&quot;@+id/lastName&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignLeft=&quot;@+id/firstName&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:layout_below=&quot;@+id/firstName&quot;
        android:ems=&quot;10&quot;
        android:hint=&quot;@string/signupLastName&quot;
        android:inputType=&quot;textPersonName&quot; &gt;

    &lt;/EditText&gt;

    &lt;EditText
        android:id=&quot;@+id/Email&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignLeft=&quot;@+id/lastName&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:layout_below=&quot;@+id/lastName&quot;
        android:ems=&quot;10&quot;
        android:hint=&quot;@string/signupEmail&quot;
        android:inputType=&quot;textEmailAddress&quot; /&gt;

    &lt;EditText
        android:id=&quot;@+id/Password&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignLeft=&quot;@+id/Email&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:layout_below=&quot;@+id/Email&quot;
        android:ems=&quot;10&quot;
        android:hint=&quot;@string/signupPassword&quot;
        android:inputType=&quot;textPassword&quot; /&gt;

    &lt;Button
        android:id=&quot;@+id/register&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignParentBottom=&quot;true&quot;
        android:layout_centerHorizontal=&quot;true&quot;
        android:layout_marginBottom=&quot;28dp&quot;
        android:onClick=&quot;registerPressed&quot;
        android:text=&quot;@string/signupRegister&quot; /&gt;

&lt;/RelativeLayout&gt;</code></pre>

          </div>
        
          <div class="ui tab segment lab" data-tab="04">
            <h1>Login View</h1>
<p>Design a new activity to look like this:</p>
<p><img src="img/02.png" alt=""></p>
<p>You may end up with new entries in the strings.xml file:</p>
<h2>res/values/strings.xml</h2>
<pre><code>    &lt;string name=&quot;loginTitle&quot;&gt;Login to Donation&lt;/string&gt;
    &lt;string name=&quot;loginSubtitle&quot;&gt;You must be reigstered&lt;/string&gt;
    &lt;string name=&quot;loginSignin&quot;&gt;Sign in&lt;/string&gt;
    &lt;string name=&quot;loginEmail&quot;&gt;Email&lt;/string&gt;
    &lt;string name=&quot;loginPassword&quot;&gt;Password&lt;/string&gt;</code></pre>
<p>And this layout:</p>
<h2>res/layout/activity_login.xml</h2>
<pre><code class="lang-xml">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:paddingBottom=&quot;@dimen/activity_vertical_margin&quot;
    android:paddingLeft=&quot;@dimen/activity_horizontal_margin&quot;
    android:paddingRight=&quot;@dimen/activity_horizontal_margin&quot;
    android:paddingTop=&quot;@dimen/activity_vertical_margin&quot;
    tools:context=&quot;org.pacemaker.controllers.Login&quot; &gt;

    &lt;TextView
        android:id=&quot;@+id/loginTitle&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignParentLeft=&quot;true&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:layout_alignParentTop=&quot;true&quot;
        android:layout_marginTop=&quot;18dp&quot;
        android:text=&quot;@string/loginTitle&quot;
        android:textAppearance=&quot;?android:attr/textAppearanceMedium&quot; /&gt;

    &lt;TextView
        android:id=&quot;@+id/loginSubtitle&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignLeft=&quot;@+id/loginTitle&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:layout_below=&quot;@+id/loginTitle&quot;
        android:text=&quot;@string/loginSubtitle&quot;
        android:textAppearance=&quot;?android:attr/textAppearanceSmall&quot; /&gt;

    &lt;EditText
        android:id=&quot;@+id/loginEmail&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignLeft=&quot;@+id/loginSubtitle&quot;
        android:layout_alignRight=&quot;@+id/loginSubtitle&quot;
        android:layout_below=&quot;@+id/loginSubtitle&quot;
        android:layout_marginTop=&quot;17dp&quot;
        android:ems=&quot;10&quot;
        android:hint=&quot;@string/loginEmail&quot;
        android:inputType=&quot;textEmailAddress&quot; &gt;

        &lt;requestFocus /&gt;
    &lt;/EditText&gt;

    &lt;EditText
        android:id=&quot;@+id/loginPassword&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_alignLeft=&quot;@+id/loginEmail&quot;
        android:layout_alignRight=&quot;@+id/loginEmail&quot;
        android:layout_below=&quot;@+id/loginEmail&quot;
        android:ems=&quot;10&quot;
        android:hint=&quot;@string/loginPassword&quot;
        android:inputType=&quot;textPassword&quot; /&gt;

    &lt;Button
        android:id=&quot;@+id/login&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_centerHorizontal=&quot;true&quot;
        android:layout_centerVertical=&quot;true&quot;
        android:onClick=&quot;signinPressed&quot;        
        android:text=&quot;@string/loginSignin&quot; /&gt;

&lt;/RelativeLayout&gt;</code></pre>

          </div>
        
          <div class="ui tab segment lab" data-tab="05">
            <h1>Activity Classes</h1>
<p>These three classes will load the views we have just created. Place them in the <code>org.pacemaker.conrollers</code> package:</p>
<h2>Welcome.java</h2>
<pre><code>package org.pacemaker.controllers;

import org.pacemaker.R;
import org.pacemaker.main.PacemakerApp;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;

public class Welcome extends Activity
{
  PacemakerApp app;

  @Override
  public void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_welcome);
    app = (PacemakerApp) getApplication();
  }

  public void loginPressed (View view) 
  {
    startActivity (new Intent(this, Login.class));
  }

  public void signupPressed (View view) 
  {
    startActivity (new Intent(this, Signup.class));
  }
}</code></pre>
<h2>Signup.java</h2>
<pre><code>package org.pacemaker.controllers;

import org.pacemaker.R;
import org.pacemaker.main.PacemakerApp;
import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.View;
import android.widget.TextView;

public class Signup extends Activity 
{
  private PacemakerApp app;

  @Override
  protected void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_signup);
    app = (PacemakerApp) getApplication();
  }

  public void registerPressed (View view) 
  {
    TextView firstName = (TextView)  findViewById(R.id.firstName);
    TextView lastName  = (TextView)  findViewById(R.id.lastName);
    TextView email     = (TextView)  findViewById(R.id.Email);
    TextView password  = (TextView)  findViewById(R.id.Password);

    startActivity (new Intent(this, Login.class));
  }
}</code></pre>
<h2>Login.java</h2>
<pre><code>package org.pacemaker.controllers;

import org.pacemaker.R;
import org.pacemaker.main.PacemakerApp;
import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.View;
import android.widget.TextView;

public class Login extends Activity
{
  PacemakerApp app;

  @Override
  protected void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_login);
  }

  public void signinPressed (View view) 
  {
    app = (PacemakerApp) getApplication();

    TextView email     = (TextView)  findViewById(R.id.loginEmail);
    TextView password  = (TextView)  findViewById(R.id.loginPassword);

    startActivity (new Intent(this, CreateActivity.class));
  }
}</code></pre>

          </div>
        
          <div class="ui tab segment lab" data-tab="06">
            <h1>Manifest</h1>
<p>These new activities must be registered in the AndroidManifest.xml:</p>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    package=&quot;org.pacemaker&quot;&gt;

    &lt;application
        android:name=&quot;.main.PacemakerApp&quot;
        android:allowBackup=&quot;true&quot;
        android:icon=&quot;@mipmap/ic_launcher&quot;
        android:label=&quot;@string/app_name&quot;
        android:supportsRtl=&quot;true&quot;
        android:theme=&quot;@style/AppTheme&quot;&gt;
        &lt;activity
            android:name=&quot;org.pacemaker.controllers.Welcome&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
        &lt;activity
            android:name=&quot;org.pacemaker.controllers.Signup&quot;&gt;
        &lt;/activity&gt;
        &lt;activity
            android:name=&quot;org.pacemaker.controllers.Login&quot;&gt;
        &lt;/activity&gt;
        &lt;activity
            android:name=&quot;org.pacemaker.controllers.CreateActivity&quot;&gt;
        &lt;/activity&gt;
        &lt;activity
            android:name=&quot;org.pacemaker.controllers.ActivitiesList&quot;&gt;
        &lt;/activity&gt;
    &lt;/application&gt;

&lt;/manifest&gt;</code></pre>
<p>Note that we have marked the <code>Welcome</code> activity as the on with the <code>intent-filter</code> MAIN</p>
<p>Run the application now. You should be able to navigate from view to view.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="07">
            <h1>Models</h1>
<p>We can introduce a new User class :</p>
<pre><code class="lang-java">package org.pacemaker.models;

public class User 
{
  public Long   id;
  public String firstname;
  public String lastname;
  public String email;
  public String password;

  public User()
  {}

  public User(String firstname, String lastname, String email, String password)
  {
    this.firstname = firstname;
    this.lastname = lastname;
    this.email = email;
    this.password = password;
  } 
}</code></pre>
<p>We already have a list of activities in the PacemakerApp class - we can introduce a map of users alongside it:</p>
<pre><code class="lang-java">  public List&lt;MyActivity&gt; activities = new ArrayList&lt;MyActivity&gt;();
  public Map&lt;String, User&gt; users     = new HashMap&lt;String, User&gt;();</code></pre>
<p>In Signup, we can create a new entry in this map :</p>
<pre><code class="lang-java">  public void registerPressed (View view) 
  {
    TextView firstName = (TextView)  findViewById(R.id.firstName);
    TextView lastName  = (TextView)  findViewById(R.id.lastName);
    TextView email     = (TextView)  findViewById(R.id.Email);
    TextView password  = (TextView)  findViewById(R.id.Password);

    User user = new User(firstName.getText().toString(), lastName.getText().toString(), email.getText().toString(), password.getText().toString());
    app.users.put(user.email, user);

    startActivity (new Intent(this, Login.class));
  }</code></pre>
<p>... and in Login we can validate the user against these entries:</p>
<pre><code class="lang-java">  public void signinPressed (View view)
  {
    app = (PacemakerApp) getApplication();

    TextView email     = (TextView)  findViewById(R.id.loginEmail);
    TextView password  = (TextView)  findViewById(R.id.loginPassword);

    String emailStr    = email.getText().toString();
    String passwordStr = password.getText().toString();

    User user = app.users.get(emailStr);
    if (user != null &amp;&amp; user.password.equals(passwordStr))
    {
      startActivity (new Intent(this, CreateActivity.class));
    }
    else
    {
      Toast toast = Toast.makeText(this, &quot;Invalid Credentials&quot;, Toast.LENGTH_SHORT);
      toast.show();
    }
  }</code></pre>
<p>We should be able to register and log in now. And if we provide invalid credentials, we should be kept out.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="08">
            <h1>Facade</h1>
<p>There are, of course, some serious problems with our app. The list of activities is not associated with any specific user, the user and activities themselves are not persisted.</p>
<p>These issues could be tackled piecemeal - in each of the respective views for instance, but we might be more advised strengthen some of the abstractions around user/activity management first.</p>
<p>This pattern here may be appropriate:</p>
<ul>
<li><a href="http://sourcemaking.com/design_patterns/facade">http://sourcemaking.com/design_patterns/facade</a></li>
</ul>
<p>Instead of a very exposed set of data structures in PacemakerApp:</p>
<pre><code class="lang-java">public class PacemakerApp extends Application
{
  public List&lt;Activity&gt;    actvities = new ArrayList&lt;Activity&gt;();
  public Map&lt;String, User&gt; users     = new HashMap&lt;String, User&gt;();

  @Override
  public void onCreate()
  {
    super.onCreate();
    Log.v(&quot;Pacemaker&quot;, &quot;Pacemaker App Started&quot;);
  }
}</code></pre>
<p>We could remodel this class to provide a encapsulated perspective - a Facade - to the these models:</p>
<pre><code class="lang-java">public class PacemakerApp extends Application
{
  private List&lt;MyActivity&gt; activities = new ArrayList&lt;MyActivity&gt;();
  public  Map&lt;String, User&gt; users     = new HashMap&lt;String, User&gt;();
  private User              loggedInUser;

  public void registerUser(User user)
  {
    users.put(user.email, user);
  }

  public boolean loginUser(String email, String password)
  {
    loggedInUser = users.get(email);
    if (loggedInUser != null &amp;&amp; !loggedInUser.password.equals(password))
    {
      loggedInUser = null;
    }
    return loggedInUser != null;
  }

  public void createActivity (MyActivity activity)
  {
    activities.add(activity);
  }

  public List&lt;MyActivity&gt; getActivities()
  {
    return activities;
  }

  @Override
  public void onCreate()
  {
    super.onCreate();
    Log.v(&quot;Pacemaker&quot;, &quot;Pacemaker App Started&quot;);
  }
}</code></pre>
<p>This will require a refactoring of most of the controllers:</p>
<h2>Signup</h2>
<pre><code class="lang-java">  public void registerPressed (View view) 
  {
    TextView firstName = (TextView)  findViewById(R.id.firstName);
    TextView lastName  = (TextView)  findViewById(R.id.lastName);
    TextView email     = (TextView)  findViewById(R.id.Email);
    TextView password  = (TextView)  findViewById(R.id.Password);

    User user = new User(firstName.getText().toString(), lastName.getText().toString(), email.getText().toString(), password.getText().toString());
    app.registerUser(user);

    startActivity (new Intent(this, Login.class));
  }</code></pre>
<h2>Login</h2>
<pre><code class="lang-java">  public void signinPressed (View view)
  {
    app = (PacemakerApp) getApplication();

    TextView email     = (TextView)  findViewById(R.id.loginEmail);
    TextView password  = (TextView)  findViewById(R.id.loginPassword);

    boolean loggedIn = app.loginUser(email.getText().toString(), password.getText().toString());
    if (loggedIn)
    {
      startActivity (new Intent(this, CreateActivity.class));
    }
    else
    {
      Toast toast = Toast.makeText(this, &quot;Invalid Credentials&quot;, Toast.LENGTH_SHORT);
      toast.show();
    }</code></pre>
<h2>CreateActivity</h2>
<pre><code class="lang-java">  public void createActivityButtonPressed (View view)
  {
    double distance = distancePicker.getValue();
    MyActivity activity = new MyActivity (activityType.getText().toString(), activityLocation.getText().toString(), distance);

    app.createActivity(activity);
    Log.v(&quot;Pacemaker&quot;, &quot;CreateActivity Button Pressed with &quot; + distance);
  }</code></pre>
<h2>ActivitiesList</h2>
<pre><code class="lang-java">  @Override
  protected void onCreate(Bundle savedInstanceState)
  {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_activities_list);

    app = (PacemakerApp) getApplication();

    activitiesListView = (ListView) findViewById(R.id.activitiesListView);

    List&lt;MyActivity&gt; activities  = app.getActivities();

    ActivityAdapter activitiesAdapter = new ActivityAdapter(this,  activities);
    activitiesListView.setAdapter(activitiesAdapter);
    activitiesAdapter.notifyDataSetChanged();
  }
}</code></pre>
<p>This should work now as expected.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="Solution">
            <h1>Archive</h1>
<p>Archive of the app so far:</p>
<ul>
<li><a href="https://github.com/wit-design-patterns-2016/pacemaker-android/releases/tag/V4">https://github.com/wit-design-patterns-2016/pacemaker-android/releases/tag/V4</a></li>
</ul>

          </div>
        
      </div>
    </div>
  </div>



  <script>
    $(document).on('keydown', function(e) {
  e = e || window.event;
  var nextTab;
  switch (e.which || e.keyCode) {
    case 37: // left
      nextTab = $('.tab-menu a[data-tab].active').prev('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').last();
      nextTab.click();
      $('.pusher').focus();
      break;

    case 39: // right
      nextTab = $('.tab-menu a[data-tab].active').next('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').first();
      nextTab.click();
      $('.pusher').focus();
      break;
  }
});

    $(document).ready(function() {
  $('img').addClass('ui image');

  $('.ui.embed').embed();

  const $images = $('.lab img');
  jQuery.each($images, function(i) {
    if ($images[i].alt.length > 0) {
      const divImg = $(document.createElement('div')).addClass(
        'ui basic segment',
      );
      $($images[i]).wrap(divImg);
      const divLabel = $(document.createElement('div')).addClass(
        'ui blue ribbon label',
      );
      divLabel.append($images[i].alt);
      $(divLabel).insertBefore($images[i]);
    }
  });

  $('.ui.menu .item').tab({
    history: true,
    historyType: 'hash',
  });

  $('.popup').popup();

  $('.ui.sidebar')
    .sidebar({ context: $('.pushable') })
    .sidebar('setting', 'transition', 'slide out')
    .sidebar('attach events', '#toc');
});

  </script>


        </div>
      </div>
      <div class="footer"> <p> Powered by <a
          href="https://github.com/edeleastar/tutors-ts">tutors-ts.</a>
        Unless otherwise stated, this work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. </p>
      </div>
    </div>
  </body>

</html>